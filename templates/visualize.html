{% extends 'base.html' %}
{% block content %}
<br>
<div class="row">
  <div class="col s2">
    <form action="#" id='id1'>
        <p>
          <label>
            <input class="with-gap" name="dataset" type="radio" value='cnn'/>
            <span>CNN</span>
          </label>
        </p>
        <p>
          <label>
            <input class="with-gap" name="dataset" type="radio" value='giga'/>
            <span>GIGAWORD</span>
          </label>
        </p>
        <p>
          <label>
            <input class="with-gap" name="dataset" type="radio" value='free'/>
            <span>FREEPRESSJOURNAL</span>
          </label>
        </p>
        <p>
          <label>
            <input class="with-gap" name="dataset" type="radio" value='dat1'/>
            <span>DATASET-2</span>
          </label>
        </p>
    </form>
    </div>
    <div class="col s10">
    <table id="table1">
    </table>
    </div>
    </div>
    <div class='row'>
      <img class = 'col s4' onerror="this.style.display = 'none'" id='img1'>
      <img class = 'col s4' onerror="this.style.display = 'none'" id='img2'>
      <img class = 'col s4' onerror="this.style.display = 'none'" id='img3'>
    </div>
    <div class='row'>
      <img class = 'col s4 offset-s1' onerror="this.style.display = 'none'" id='img4'>
      <img class = 'col s4 offset-s1' onerror="this.style.display = 'none'" id='img5'>
    </div>
    <script type="text/javascript">
      function createtable(res) {
        var table = document.getElementById('table1');
        table.innerHTML='';
        for (var key in res) {
          var tr = document.createElement('tr');
          var td1 = document.createElement('td');
          var td2 = document.createElement('td');
          td1.innerHTML = key;
          td2.innerHTML = res[key];
          tr.appendChild(td1);
          tr.appendChild(td2);
          table.appendChild(tr);
        }
      }

      function images(res) {
        list = ['_mean_cmp_ratio.png', '_mean_ext_coverage.png', '_mean_ext_density.png', '_mean_word_article.png', '_mean_word_highlight.png'];
        for(var i=0; i < 5; i++) {
          list[i]=res+list[i];
        }
        console.log(list);
        document.getElementById('img1').src='static/'+list[0];
        document.getElementById('img2').src='static/'+list[1];
        document.getElementById('img3').src='static/'+list[2];
        document.getElementById('img4').src='static/'+list[3];
        document.getElementById('img5').src='static/'+list[4];
      }

      function radiobutton()
      {
        var dataset = document.querySelector('input[name = dataset]:checked');
        if(!dataset)
        {
          console.log('dataset');
          return false;
        }
        var xhr = new XMLHttpRequest();
        var url = '/api/visualize';
        xhr.open('POST', url, 'true');
        xhr.onload = function() {
          if(xhr.readyState==4 && xhr.status == '200') {
            var res = JSON.parse(xhr.responseText);
            createtable(res);
            images(dataset.value);
          }
          else {
            createtable(JSON.parse('{"abcd":"1" }'));
            console.log('hey');
          }
        }
        xhr.setRequestHeader('Content-Type', 'text/plain');
        xhr.send(dataset.value);
      }
      var rad = document.getElementsByName('dataset');
      console.log(rad);
      for (var i = 0; i < rad.length; i++) {
          rad[i].addEventListener('change', radiobutton);
      }
    </script>
{% endblock %}